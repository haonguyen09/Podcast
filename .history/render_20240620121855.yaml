services:
  - type: web
    name: frontend
    env: docker
    dockerfilePath: ./front-end/Dockerfile
    buildContextPath: ./front-end
    envVars:
      - key: REACT_APP_API
        value: http://localhost:3005/api
    ports:
      - port: 3000
    buildCommand: yarn build
    startCommand: yarn start

  - type: web
    name: backend
    env: docker
    dockerfilePath: ./backend/Dockerfile
    buildContextPath: ./backend
    envVars:
      - key: PORT
        value: 3005
      - key: MONGO_DB
        value: mongodb+srv://haonguyen09450:18witkXUGMYgdnQv@cluster0.nedaywk.mongodb.net/PodcastDB?retryWrites=true&w=majority&appName=Cluster0
      - key: ACCESS_TOKEN
        value: access_token
      - key: REFRESH_TOKEN
        value: refresh_token
    ports:
      - port: 3005
    buildCommand: npm install
    startCommand: npm start
    volumes:
      - type: persistent
        name: backend-uploads
        mountPath: /app/uploads

volumes:
  backend-uploads:
    type: persistent
